CREATE TABLE default.sharded_session_replay_embeddings (`session_id` String, `team_id` Int64, `embeddings` Array(Float32), `generation_timestamp` DateTime64(6, 'UTC') DEFAULT now('UTC'), `source_type` LowCardinality(String), `input` String) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/posthog.session_replay_embeddings', '{replica}') PARTITION BY toYYYYMM(generation_timestamp) ORDER BY (toDate(generation_timestamp), team_id, session_id) TTL toDate(generation_timestamp) + toIntervalYear(1) SETTINGS index_granularity = 512