CREATE MATERIALIZED VIEW default.events_json_mv TO default.writable_events (`uuid` UUID, `event` String, `properties` String, `timestamp` DateTime64(6, 'UTC'), `team_id` Int64, `distinct_id` String, `elements_chain` String, `created_at` DateTime64(6, 'UTC'), `person_id` UUID, `person_created_at` DateTime64(3), `person_properties` String, `group0_properties` String, `group1_properties` String, `group2_properties` String, `group3_properties` String, `group4_properties` String, `group0_created_at` DateTime64(3), `group1_created_at` DateTime64(3), `group2_created_at` DateTime64(3), `group3_created_at` DateTime64(3), `group4_created_at` DateTime64(3), `person_mode` Enum8('full' = 0, 'propertyless' = 1, 'force_upgrade' = 2), `_timestamp` Nullable(DateTime), `_offset` UInt64, `consumer_breadcrumbs` Array(String)) AS SELECT uuid, event, properties, timestamp, team_id, distinct_id, elements_chain, created_at, person_id, person_created_at, person_properties, group0_properties, group1_properties, group2_properties, group3_properties, group4_properties, group0_created_at, group1_created_at, group2_created_at, group3_created_at, group4_created_at, person_mode, _timestamp, _offset, arrayMap(i -> (_headers.value[i]), arrayFilter(i -> ((_headers.name[i]) = 'kafka-consumer-breadcrumbs'), arrayEnumerate(_headers.name))) AS consumer_breadcrumbs FROM default.kafka_events_json