CREATE MATERIALIZED VIEW default.events_plugin_ingestion_overflow_partition_statistics_v2_mv TO default.events_plugin_ingestion_partition_statistics_v2 (`topic` LowCardinality(String), `partition` UInt64, `offset` UInt64, `token` String, `distinct_id` String, `ip` Tuple(IPv4, IPv6), `event` String, `data_length` UInt64, `timestamp` Nullable(DateTime)) AS SELECT _topic AS topic, _partition AS partition, _offset AS offset, token, distinct_id, (toIPv4OrDefault(kafka_table.ip), toIPv6OrDefault(kafka_table.ip)) AS ip, JSONExtractString(data, 'event') AS event, length(data) AS data_length, _timestamp AS timestamp FROM default.kafka_events_plugin_ingestion_overflow_partition_statistics AS kafka_table