CREATE TABLE default.sharded_app_metrics2 (`team_id` Int64, `timestamp` DateTime64(6, 'UTC'), `app_source` LowCardinality(String), `app_source_id` String, `instance_id` String, `metric_kind` LowCardinality(String), `metric_name` LowCardinality(String), `count` SimpleAggregateFunction(sum, Int64), `_timestamp` DateTime, `_offset` UInt64, `_partition` UInt64) ENGINE = ReplicatedAggregatingMergeTree('/clickhouse/tables/{shard}/posthog.sharded_app_metrics2', '{replica}') PARTITION BY toYYYYMM(timestamp) ORDER BY (team_id, app_source, app_source_id, instance_id, toStartOfHour(timestamp), metric_kind, metric_name) TTL toDate(timestamp) + toIntervalDay(90) SETTINGS index_granularity = 8192