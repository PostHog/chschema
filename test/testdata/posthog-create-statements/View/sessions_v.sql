CREATE VIEW default.sessions_v (`session_id` String, `team_id` Int64, `distinct_id` SimpleAggregateFunction(any, String), `min_timestamp` SimpleAggregateFunction(min, DateTime64(6, 'UTC')), `max_timestamp` SimpleAggregateFunction(max, DateTime64(6, 'UTC')), `urls` Array(String), `entry_url` String, `exit_url` String, `initial_utm_source` String, `initial_utm_campaign` String, `initial_utm_medium` String, `initial_utm_term` String, `initial_utm_content` String, `initial_referring_domain` String, `initial_gclid` String, `initial_gad_source` String, `initial_gclsrc` String, `initial_dclid` String, `initial_gbraid` String, `initial_wbraid` String, `initial_fbclid` String, `initial_msclkid` String, `initial_twclid` String, `initial_li_fat_id` String, `initial_mc_cid` String, `initial_igshid` String, `initial_ttclid` String, `initial_epik` String, `initial_qclid` String, `initial_sccid` String, `event_count_map` Map(String, Int64), `pageview_count` Int64, `autocapture_count` Int64) AS SELECT session_id, team_id, any(distinct_id) AS distinct_id, min(min_timestamp) AS min_timestamp, max(max_timestamp) AS max_timestamp, arrayDistinct(arrayFlatten(groupArray(urls))) AS urls, argMinMerge(entry_url) AS entry_url, argMaxMerge(exit_url) AS exit_url, argMinMerge(initial_utm_source) AS initial_utm_source, argMinMerge(initial_utm_campaign) AS initial_utm_campaign, argMinMerge(initial_utm_medium) AS initial_utm_medium, argMinMerge(initial_utm_term) AS initial_utm_term, argMinMerge(initial_utm_content) AS initial_utm_content, argMinMerge(initial_referring_domain) AS initial_referring_domain, argMinMerge(initial_gclid) AS initial_gclid, argMinMerge(initial_gad_source) AS initial_gad_source, argMinMerge(initial_gclsrc) AS initial_gclsrc, argMinMerge(initial_dclid) AS initial_dclid, argMinMerge(initial_gbraid) AS initial_gbraid, argMinMerge(initial_wbraid) AS initial_wbraid, argMinMerge(initial_fbclid) AS initial_fbclid, argMinMerge(initial_msclkid) AS initial_msclkid, argMinMerge(initial_twclid) AS initial_twclid, argMinMerge(initial_li_fat_id) AS initial_li_fat_id, argMinMerge(initial_mc_cid) AS initial_mc_cid, argMinMerge(initial_igshid) AS initial_igshid, argMinMerge(initial_ttclid) AS initial_ttclid, argMinMerge(initial_epik) AS initial_epik, argMinMerge(initial_qclid) AS initial_qclid, argMinMerge(initial_sccid) AS initial_sccid, sumMap(event_count_map) AS event_count_map, sum(pageview_count) AS pageview_count, sum(autocapture_count) AS autocapture_count FROM default.sessions GROUP BY session_id, team_id