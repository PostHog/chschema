CREATE VIEW default.raw_sessions_v (`session_id_v7` UInt128, `session_timestamp` DateTime, `team_id` Int64, `distinct_id` String, `min_timestamp` SimpleAggregateFunction(min, DateTime64(6, 'UTC')), `max_timestamp` SimpleAggregateFunction(max, DateTime64(6, 'UTC')), `max_inserted_at` SimpleAggregateFunction(max, DateTime64(6, 'UTC')), `urls` Array(String), `entry_url` String, `end_url` String, `last_external_click_url` String, `initial_browser` String, `initial_browser_version` String, `initial_os` String, `initial_os_version` String, `initial_device_type` String, `initial_viewport_width` Int64, `initial_viewport_height` Int64, `initial_geoip_country_code` String, `initial_geoip_subdivision_1_code` String, `initial_geoip_subdivision_1_name` String, `initial_geoip_subdivision_city_name` String, `initial_geoip_time_zone` String, `initial_utm_source` String, `initial_utm_campaign` String, `initial_utm_medium` String, `initial_utm_term` String, `initial_utm_content` String, `initial_referring_domain` String, `initial_gclid` String, `initial_gad_source` String, `initial_gclsrc` String, `initial_dclid` String, `initial_gbraid` String, `initial_wbraid` String, `initial_fbclid` String, `initial_msclkid` String, `initial_twclid` String, `initial_li_fat_id` String, `initial_mc_cid` String, `initial_igshid` String, `initial_ttclid` String, `initial__kx` String, `initial_irclid` String, `pageview_count` Int64, `pageview_uniq` UInt64, `autocapture_count` Int64, `autocapture_uniq` UInt64, `screen_count` Int64, `screen_uniq` UInt64, `maybe_has_session_replay` SimpleAggregateFunction(max, Bool), `page_screen_autocapture_uniq_up_to` UInt64, `vitals_lcp` Nullable(Float64)) AS SELECT session_id_v7, fromUnixTimestamp(intDiv(toUInt64(bitShiftRight(session_id_v7, 80)), 1000)) AS session_timestamp, team_id, argMaxMerge(distinct_id) AS distinct_id, min(min_timestamp) AS min_timestamp, max(max_timestamp) AS max_timestamp, max(max_inserted_at) AS max_inserted_at, arrayDistinct(arrayFlatten(groupArray(urls))) AS urls, argMinMerge(entry_url) AS entry_url, argMaxMerge(end_url) AS end_url, argMaxMerge(last_external_click_url) AS last_external_click_url, argMinMerge(initial_browser) AS initial_browser, argMinMerge(initial_browser_version) AS initial_browser_version, argMinMerge(initial_os) AS initial_os, argMinMerge(initial_os_version) AS initial_os_version, argMinMerge(initial_device_type) AS initial_device_type, argMinMerge(initial_viewport_width) AS initial_viewport_width, argMinMerge(initial_viewport_height) AS initial_viewport_height, argMinMerge(initial_geoip_country_code) AS initial_geoip_country_code, argMinMerge(initial_geoip_subdivision_1_code) AS initial_geoip_subdivision_1_code, argMinMerge(initial_geoip_subdivision_1_name) AS initial_geoip_subdivision_1_name, argMinMerge(initial_geoip_subdivision_city_name) AS initial_geoip_subdivision_city_name, argMinMerge(initial_geoip_time_zone) AS initial_geoip_time_zone, argMinMerge(initial_utm_source) AS initial_utm_source, argMinMerge(initial_utm_campaign) AS initial_utm_campaign, argMinMerge(initial_utm_medium) AS initial_utm_medium, argMinMerge(initial_utm_term) AS initial_utm_term, argMinMerge(initial_utm_content) AS initial_utm_content, argMinMerge(initial_referring_domain) AS initial_referring_domain, argMinMerge(initial_gclid) AS initial_gclid, argMinMerge(initial_gad_source) AS initial_gad_source, argMinMerge(initial_gclsrc) AS initial_gclsrc, argMinMerge(initial_dclid) AS initial_dclid, argMinMerge(initial_gbraid) AS initial_gbraid, argMinMerge(initial_wbraid) AS initial_wbraid, argMinMerge(initial_fbclid) AS initial_fbclid, argMinMerge(initial_msclkid) AS initial_msclkid, argMinMerge(initial_twclid) AS initial_twclid, argMinMerge(initial_li_fat_id) AS initial_li_fat_id, argMinMerge(initial_mc_cid) AS initial_mc_cid, argMinMerge(initial_igshid) AS initial_igshid, argMinMerge(initial_ttclid) AS initial_ttclid, argMinMerge(initial__kx) AS initial__kx, argMinMerge(initial_irclid) AS initial_irclid, sum(pageview_count) AS pageview_count, uniqMerge(pageview_uniq) AS pageview_uniq, sum(autocapture_count) AS autocapture_count, uniqMerge(autocapture_uniq) AS autocapture_uniq, sum(screen_count) AS screen_count, uniqMerge(screen_uniq) AS screen_uniq, max(maybe_has_session_replay) AS maybe_has_session_replay, uniqUpToMerge(1)(page_screen_autocapture_uniq_up_to) AS page_screen_autocapture_uniq_up_to, argMinMerge(vitals_lcp) AS vitals_lcp FROM default.raw_sessions GROUP BY session_id_v7, team_id