CREATE VIEW default.web_stats_combined (`period_bucket` DateTime, `team_id` UInt64, `host` String, `device_type` String, `pathname` String, `entry_pathname` String, `end_pathname` String, `browser` String, `os` String, `viewport_width` Int64, `viewport_height` Int64, `referring_domain` String, `utm_source` String, `utm_medium` String, `utm_campaign` String, `utm_term` String, `utm_content` String, `country_code` String, `city_name` String, `region_code` String, `region_name` String, `has_gclid` Bool, `has_gad_source_paid_search` Bool, `has_fbclid` Bool, `mat_metadata_loggedIn` Bool, `mat_metadata_backend` String, `persons_uniq_state` AggregateFunction(uniq, UUID), `sessions_uniq_state` AggregateFunction(uniq, String), `pageviews_count_state` AggregateFunction(sum, UInt64)) AS SELECT * FROM default.web_stats_daily WHERE period_bucket < toStartOfDay(now(), 'UTC') UNION ALL SELECT * FROM default.web_stats_hourly WHERE period_bucket >= toStartOfDay(now(), 'UTC')