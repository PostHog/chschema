CREATE DICTIONARY default.exchange_rate_dict (`currency` String, `start_date` Date, `end_date` Nullable(Date), `rate` Decimal64(10)) PRIMARY KEY currency SOURCE(CLICKHOUSE(QUERY 'SELECT currency, date AS start_date, leadInFrame(date::Nullable(Date), 1, NULL::Nullable(Date)) OVER w AS end_date, argMax(rate, version) AS rate FROM `default`.`exchange_rate` GROUP BY date, currency WINDOW w AS ( PARTITION BY currency ORDER BY date ASC ROWS BETWEEN 1 FOLLOWING AND 1 FOLLOWING )' USER 'default' PASSWORD '[HIDDEN]')) LIFETIME(MIN 3000 MAX 3600) LAYOUT(COMPLEX_KEY_RANGE_HASHED(RANGE_LOOKUP_STRATEGY 'max')) RANGE(MIN start_date MAX end_date)